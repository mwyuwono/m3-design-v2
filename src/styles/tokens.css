@import url('https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;500;700&family=Manrope:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

:root {
  /* --- COLOR SYSTEM: Visual Identity v1.0 (Refined) --- */

  /* Primary: Hunter Green (Refined) */
  --md-sys-color-primary: #2C4C3B;
  --md-sys-color-on-primary: #FFFFFF;
  --md-sys-color-primary-container: #E8F5E9;
  /* Pale wash */
  --md-sys-color-on-primary-container: #002114;

  /* Secondary / Surface Tones */
  --md-sys-color-secondary: #8C7E70;
  /* Muted Gold/Bronze kept as accent */
  --md-sys-color-on-secondary: #FFFFFF;

  /* Backgrounds & Surfaces (Light) */
  --md-sys-color-background: #FDFBF7;
  /* Alabaster */
  --md-sys-color-on-background: #121714;
  /* Deep Green-Black */

  /* Surfaces & Containers */
  --md-sys-color-surface: #F5F2EA;
  /* Warm Clay */
  --md-sys-color-on-surface: #121714;
  --md-sys-color-surface-variant: #EBE5DE;
  --md-sys-color-on-surface-variant: #49454E;

  /* Missing M3 Containers (Derived from Palette) */
  --md-sys-color-surface-container-lowest: #FFFFFF;
  --md-sys-color-surface-container-low: #FDFBF7;
  /* Alabaster */
  --md-sys-color-surface-container: #F5F2EA;
  /* Warm Clay */
  --md-sys-color-surface-container-high: #EBE5DE;
  --md-sys-color-surface-container-highest: #D7D3C8;

  --md-sys-color-secondary-container: #EBE5DE;
  /* Matching Surface Variant */
  --md-sys-color-on-secondary-container: #2d312f;
  /* Darker text */

  /* Inverse Tokens (for Toasts/Snackbars) */
  --md-sys-color-inverse-surface: #121714;
  /* Dark for light mode */
  --md-sys-color-inverse-on-surface: #F5F2EA;
  /* Light text on inverse */

  /* Outlines & Borders */
  --md-sys-color-outline: #2d4e3c;
  --md-sys-color-outline-variant: #D7D3C8;
  --md-sys-color-border-variant: #EBE5DA;

  /* Semantic Text */
  --md-sys-color-text-main: #121714;
  --md-sys-color-text-muted: #667f71;
  
  /* Links Modal Specific Colors (exact match to Tailwind stone palette from reference design) */
  /* These are component-specific colors that don't align with M3 semantic tokens */
  --wy-links-modal-title-color: #1C1917;        /* stone-900: rgb(28, 25, 23) */
  --wy-links-modal-header-color: #292524;       /* stone-800: rgb(41, 37, 36) */
  --wy-links-modal-chip-text-color: #44403C;    /* stone-700: rgb(68, 64, 60) */
  --wy-links-modal-close-color: #A8A29E;        /* stone-400: rgb(168, 162, 158) */
  --wy-links-modal-chip-border: #D9D4C7;        /* accent-taupe: rgb(217, 212, 199) */
  
  /* Dropdown Component Colors (exact match to Tailwind zinc palette from reference design) */
  /* Reference uses zinc palette which has delta E > 2.0 from M3 semantic tokens, requiring component-specific tokens for perfect visual fidelity */
  --wy-dropdown-label-color: #71717A;           /* zinc-500: rgb(113, 113, 122) - Δ 19.95 from --md-sys-color-text-muted */
  --wy-dropdown-text-color: #52525B;            /* zinc-600: rgb(82, 82, 91) - Δ 20.47 from --md-sys-color-on-surface-variant */
  --wy-dropdown-icon-color: #52525B;            /* zinc-600: rgb(82, 82, 91) - matches text for consistency */
  --wy-dropdown-bg: var(--md-sys-color-surface); /* #F5F2EA - exact match */
  --wy-dropdown-border: #E5E7EB;                /* zinc-200: rgb(229, 231, 235) - default transparent, visible on hover */
  --wy-dropdown-border-hover: var(--md-sys-color-outline-variant); /* Use design system token for hover */
  --wy-dropdown-menu-bg: var(--md-sys-color-surface-container-high); /* Dropdown menu background - changed to high for better contrast */
  --wy-dropdown-item-hover-bg: var(--md-sys-color-surface-container-high); /* Menu item hover */
  
  /* Info Panel Component Colors */
  --wy-info-panel-bg: var(--md-sys-color-background); /* #FDFBF7 - exact match */
  --wy-info-panel-border: var(--md-sys-color-surface-container-highest); /* #D7D3C8 - exact match */
  --wy-info-panel-text-color: #52525B;          /* zinc-600: rgb(82, 82, 91) - Δ 20.47 from --md-sys-color-on-surface-variant */

  /* Library Header Component Colors */
  /* Status color for backup sync indicator - Tailwind status-green from reference design */
  /* This is a semantic success color that doesn't exist in M3 palette */
  --wy-status-success-color: #438E64;           /* rgb(67, 142, 100) - Tailwind custom status-green */
  
  /* Glass morphism effect for scrolled header state */
  /* Semi-transparent background with backdrop blur for sticky header */
  --wy-library-header-scrolled-bg: rgba(248, 247, 244, 0.8);  /* Alabaster with 80% opacity */
  --wy-library-header-scrolled-blur: 14px;

  /* --- TYPOGRAPHY FAMILIES --- */
  --font-display: 'Playfair Display', serif;
  /* Display Serif */
  --font-serif: 'Playfair Display', serif;
  /* Editorial Headings (Serif) */
  --font-sans: 'DM Sans', sans-serif;
  /* Sans UI/Body */
  --font-body: var(--font-sans);
  /* Standardizing Body to Sans */

  /* M3 Typography Token Overrides */
  --md-sys-typescale-display-large-font: var(--font-serif);
  --md-sys-typescale-display-medium-font: var(--font-serif);
  --md-sys-typescale-display-small-font: var(--font-serif);

  --md-sys-typescale-headline-large-font: var(--font-serif);
  --md-sys-typescale-headline-medium-font: var(--font-serif);
  --md-sys-typescale-headline-small-font: var(--font-serif);

  --md-sys-typescale-title-large-font: var(--font-serif);
  --md-sys-typescale-title-medium-font: var(--font-body);
  --md-sys-typescale-title-small-font: var(--font-body);

  --md-sys-typescale-body-large-font: var(--font-body);
  --md-sys-typescale-body-medium-font: var(--font-body);
  --md-sys-typescale-body-small-font: var(--font-body);

  --md-sys-typescale-label-large-font: var(--font-sans);
  --md-sys-typescale-label-medium-font: var(--font-sans);
  --md-sys-typescale-label-small-font: var(--font-sans);

  /* --- SPACING & SHAPE --- */
  
  /* Layout Spacing (for page-level margins and section gaps) */
  --spacing-layout: 120px;
  --spacing-gap: 64px;

  /* Component Spacing Scale (8px baseline grid) */
  --spacing-xxs: 0.125rem;  /* 2px */
  --spacing-xs: 0.25rem;    /* 4px */
  --spacing-sm: 0.5rem;     /* 8px */
  --spacing-md: 1rem;       /* 16px */
  --spacing-lg: 1.5rem;     /* 24px */
  --spacing-xl: 2rem;       /* 32px */
  --spacing-2xl: 3rem;      /* 48px */
  --spacing-3xl: 4rem;      /* 64px - same as --spacing-gap */

  /* Shape (Border Radius) */
  --md-sys-shape-corner-full: 9999px;
  --md-sys-shape-corner-large: 32px;
  --md-sys-shape-corner-medium: 16px;
  --md-sys-shape-corner-small: 8px;
  --md-sys-shape-corner-xs: 4px;

  /* --- MOTION TOKENS --- */
  /* Easing Curves */
  --md-sys-motion-easing-standard: cubic-bezier(0.2, 0, 0, 1);
  --md-sys-motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);
  --md-sys-motion-easing-emphasized-decelerate: cubic-bezier(0.05, 0.7, 0.1, 1);
  --md-sys-motion-easing-emphasized-accelerate: cubic-bezier(0.3, 0, 0.8, 0.15);
  --md-sys-motion-easing-legacy: cubic-bezier(0.4, 0, 0.2, 1);
  --md-sys-motion-easing-spring: cubic-bezier(0.34, 1.56, 0.64, 1);

  /* Duration Scale */
  --md-sys-motion-duration-short1: 50ms;
  --md-sys-motion-duration-short2: 100ms;
  --md-sys-motion-duration-short3: 150ms;
  --md-sys-motion-duration-short4: 200ms;
  --md-sys-motion-duration-medium1: 250ms;
  --md-sys-motion-duration-medium2: 300ms;
  --md-sys-motion-duration-medium3: 350ms;
  --md-sys-motion-duration-medium4: 400ms;
  --md-sys-motion-duration-long1: 450ms;
  --md-sys-motion-duration-long2: 500ms;
  --md-sys-motion-duration-long3: 550ms;
  --md-sys-motion-duration-long4: 600ms;

  /* --- STATE TOKENS --- */
  /* Opacity values for Material Design 3 state layers */
  --md-sys-state-hover-opacity: 0.08;
  --md-sys-state-focus-opacity: 0.12;
  --md-sys-state-pressed-opacity: 0.12;
  --md-sys-state-dragged-opacity: 0.16;
  --md-sys-state-disabled-opacity: 0.38;
  --md-sys-state-disabled-container-opacity: 0.12;

  /* --- COMPONENT TOKENS --- */
  --wy-controls-bar-bg: var(--md-sys-color-primary);
  --wy-controls-bar-fg: var(--md-sys-color-on-primary);
  --wy-controls-search-bg: var(--md-sys-color-surface-container-high);
  --wy-controls-toggle-bg: var(--md-sys-color-surface-container-high);
  --wy-controls-chip-text: color-mix(in srgb, var(--wy-controls-bar-fg) 60%, transparent);
  --wy-controls-chip-text-hover: var(--wy-controls-bar-fg);
  --wy-controls-chip-border: color-mix(in srgb, var(--wy-controls-bar-fg) 20%, transparent);
  --wy-controls-chip-border-hover: color-mix(in srgb, var(--wy-controls-bar-fg) 40%, transparent);
  --wy-controls-chip-hover-bg: color-mix(in srgb, var(--wy-controls-bar-fg) 5%, transparent);
  --wy-controls-chip-focus: color-mix(in srgb, var(--wy-controls-bar-fg) 50%, transparent);
  --wy-controls-chip-active-bg: #E8F5E9;
  --wy-controls-chip-active-fg: #2C4C3B;
  --wy-controls-chip-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);

  --wy-filter-chip-text: var(--md-sys-color-on-background);
  --wy-filter-chip-text-hover: var(--md-sys-color-on-background);
  --wy-filter-chip-border: var(--md-sys-color-outline-variant);
  --wy-filter-chip-border-hover: var(--md-sys-color-outline);
  --wy-filter-chip-hover-bg: var(--md-sys-color-surface-variant);
  --wy-filter-chip-focus: var(--md-sys-color-primary);
  --wy-filter-chip-active-bg: var(--md-sys-color-primary);
  --wy-filter-chip-active-fg: var(--md-sys-color-on-primary);
  --wy-filter-chip-font-weight: 500;
  --wy-filter-chip-shadow: none;
  --wy-filter-chip-font-family: var(--font-sans);
  --wy-filter-chip-font-size: var(--md-sys-typescale-label-medium-size, 0.75rem);
  --wy-filter-chip-font-weight: 500;
  --wy-filter-chip-font-weight-active: 600;
  --wy-filter-chip-font-style: normal;
  --wy-filter-chip-padding: 8px 16px;

  /* --- BUTTON SYSTEM TOKENS --- */
  /* Visual Identity Guide v1.0 - Button System */
  
  /* Primary Button (Filled Hunter Green) */
  --wy-button-primary-bg: var(--md-sys-color-primary);
  --wy-button-primary-fg: var(--md-sys-color-on-primary);
  --wy-button-primary-hover-bg: #1e3428;
  --wy-button-primary-shadow-hover: 0 10px 25px -5px rgba(44, 76, 59, 0.25);
  
  /* Secondary Button (Tonal - Warm Clay) */
  --wy-button-secondary-bg: var(--md-sys-color-surface);
  --wy-button-secondary-fg: var(--md-sys-color-primary);
  --wy-button-secondary-hover-bg: color-mix(in srgb, var(--md-sys-color-surface) 95%, black);
  
  /* Outlined Button (Editorial) */
  --wy-button-outlined-bg: transparent;
  --wy-button-outlined-fg: var(--md-sys-color-primary);
  --wy-button-outlined-border: var(--md-sys-color-surface-container-highest);
  --wy-button-outlined-hover-bg: color-mix(in srgb, var(--md-sys-color-surface) 30%, transparent);
  
  /* Text Button (Utility) */
  --wy-button-text-fg: var(--md-sys-color-primary);
  --wy-button-text-fg-muted: color-mix(in srgb, var(--md-sys-color-primary) 60%, transparent);
  --wy-button-text-hover-bg: color-mix(in srgb, var(--md-sys-color-primary) 5%, transparent);
  
  /* Icon Button */
  --wy-icon-button-filled-bg: var(--md-sys-color-primary);
  --wy-icon-button-filled-fg: var(--md-sys-color-on-primary);
  --wy-icon-button-filled-shadow: 0 4px 12px rgba(44, 76, 59, 0.2);
  --wy-icon-button-outlined-bg: var(--md-sys-color-background);
  --wy-icon-button-outlined-fg: var(--md-sys-color-primary);
  --wy-icon-button-outlined-border: color-mix(in srgb, var(--md-sys-color-primary) 20%, transparent);
  
  /* Utility Tag */
  --wy-utility-tag-bg: color-mix(in srgb, var(--md-sys-color-primary) 5%, transparent);
  --wy-utility-tag-fg: var(--md-sys-color-primary);
  --wy-utility-tag-border: color-mix(in srgb, var(--md-sys-color-primary) 10%, transparent);
  --wy-utility-tag-add-border: color-mix(in srgb, var(--md-sys-color-primary) 30%, transparent);
  --wy-utility-tag-add-fg: color-mix(in srgb, var(--md-sys-color-primary) 40%, transparent);
  
  /* Button Typography */
  --wy-button-tracking-architectural: 0.1em;
  --wy-button-font-weight: 500;
}

/* --- DARK MODE OVERRIDES --- */
/* Based on Visual Identity Guide v1.0 dark mode specification */
/* Supports both system preference (prefers-color-scheme) and manual toggle (html.dark class) */
@media (prefers-color-scheme: dark) {
  :root {
    /* Primary: Hunter Green remains the accent color in dark mode */
    --md-sys-color-primary: #2D4E3C;
    --md-sys-color-on-primary: #FFFFFF;
    /* White text on Hunter Green */
    --md-sys-color-primary-container: #2D4E3C;
    /* Hunter Green container */
    --md-sys-color-on-primary-container: #FFFFFF;
    /* White text/icon on Hunter Green container */

    /* Background: Deep Dark (#161C19) */
    --md-sys-color-background: #161C19;
    --md-sys-color-on-background: #F5F2EA;
    /* Warm Clay text */

    /* Surface: Slightly lighter dark (#1E2622) */
    --md-sys-color-surface: #1E2622;
    --md-sys-color-on-surface: #F5F2EA;

    --md-sys-color-surface-variant: #2C3631;
    --md-sys-color-on-surface-variant: #F5F2EA;

    /* Surface containers: graduated dark tones */
    --md-sys-color-surface-container-lowest: #121714;
    --md-sys-color-surface-container-low: #161C19;
    --md-sys-color-surface-container: #1E2622;
    --md-sys-color-surface-container-high: #2C3631;
    --md-sys-color-surface-container-highest: #3E4944;

    --md-sys-color-secondary-container: #2C3631;
    --md-sys-color-on-secondary-container: #F5F2EA;

    /* Inverse: Light surface for dark mode overlays */
    --md-sys-color-inverse-surface: #F5F2EA;
    --md-sys-color-inverse-on-surface: #1E2622;

    /* Outlines: Hunter Green for borders, subtle variant for dividers */
    --md-sys-color-outline: #2D4E3C;
    --md-sys-color-outline-variant: rgba(255, 255, 255, 0.1);
    --md-sys-color-border-variant: rgba(255, 255, 255, 0.1);

    /* Text: Warm Clay (#F5F2EA) for main, muted for secondary */
    --md-sys-color-text-main: #F5F2EA;
    --md-sys-color-text-muted: rgba(245, 242, 234, 0.7);
    
    /* Links Modal Specific Colors (dark mode) */
    --wy-links-modal-text-muted: rgba(245, 242, 234, 0.7); /* Muted text in dark mode */
    --wy-links-modal-chip-border: rgba(255, 255, 255, 0.1); /* Subtle border in dark mode */
    
    /* Dropdown Component Colors (dark mode) */
    --wy-dropdown-label-color: #A1A1AA;         /* zinc-400: lighter gray for dark mode labels */
    --wy-dropdown-text-color: #E4E4E7;          /* zinc-200: high contrast text for dark mode */
    --wy-dropdown-icon-color: #A1A1AA;          /* zinc-400: matches label color */
    --wy-dropdown-bg: #18181B;                  /* zinc-900: dark background for dropdown */
    --wy-dropdown-border: #3F3F46;              /* zinc-700: darker border for dark mode */
    --wy-dropdown-menu-bg: #27272A;             /* zinc-800: slightly lighter for menu */
    --wy-dropdown-item-hover-bg: #3F3F46;       /* zinc-700: hover state for menu items */
    
    /* Info Panel Component Colors (dark mode) */
    --wy-info-panel-bg: rgba(24, 24, 27, 0.5);  /* zinc-900 with transparency */
    --wy-info-panel-border: #27272A;            /* zinc-800: subtle border in dark mode */
    --wy-info-panel-text-color: #A1A1AA;        /* zinc-400: muted text for dark mode */
    
    /* Library Header Component Colors (dark mode) */
    --wy-status-success-color: #66BB8A;         /* Lighter green for better contrast in dark mode */
    --wy-library-header-scrolled-bg: rgba(18, 18, 18, 0.3);  /* Dark with 30% opacity for glass morphism */
    
    /* Button System Tokens (dark mode) */
    --wy-button-primary-hover-bg: #3A5F4A;      /* Lighter hover in dark mode */
    --wy-button-primary-shadow-hover: 0 10px 25px -5px rgba(45, 78, 60, 0.4);
    --wy-button-secondary-bg: var(--md-sys-color-surface-container);
    --wy-button-secondary-hover-bg: var(--md-sys-color-surface-container-high);
    --wy-button-outlined-border: rgba(255, 255, 255, 0.2);
    --wy-button-outlined-hover-bg: rgba(255, 255, 255, 0.05);
    --wy-button-text-fg: var(--md-sys-color-on-background);
    --wy-button-text-fg-muted: rgba(245, 242, 234, 0.6);
    --wy-button-text-hover-bg: rgba(255, 255, 255, 0.05);
    --wy-icon-button-filled-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    --wy-icon-button-outlined-bg: var(--md-sys-color-surface-container);
    --wy-icon-button-outlined-border: rgba(255, 255, 255, 0.2);
    --wy-utility-tag-bg: rgba(255, 255, 255, 0.05);
    --wy-utility-tag-fg: var(--md-sys-color-on-background);
    --wy-utility-tag-border: rgba(255, 255, 255, 0.1);
    --wy-utility-tag-add-border: rgba(255, 255, 255, 0.2);
    --wy-utility-tag-add-fg: rgba(255, 255, 255, 0.4);
  }
}

/* Dark mode via manual toggle (html.dark class) - mirrors system preference dark mode */
html.dark :root {
  /* Primary: Hunter Green remains the accent color in dark mode */
  --md-sys-color-primary: #2D4E3C;
  --md-sys-color-on-primary: #FFFFFF;
  --md-sys-color-primary-container: #2D4E3C;
  --md-sys-color-on-primary-container: #FFFFFF;

  /* Background: Deep Dark (#161C19) */
  --md-sys-color-background: #161C19;
  --md-sys-color-on-background: #F5F2EA;

  /* Surface: Slightly lighter dark (#1E2622) */
  --md-sys-color-surface: #1E2622;
  --md-sys-color-on-surface: #F5F2EA;

  --md-sys-color-surface-variant: #2C3631;
  --md-sys-color-on-surface-variant: #F5F2EA;

  /* Surface containers: graduated dark tones */
  --md-sys-color-surface-container-lowest: #121714;
  --md-sys-color-surface-container-low: #161C19;
  --md-sys-color-surface-container: #1E2622;
  --md-sys-color-surface-container-high: #2C3631;
  --md-sys-color-surface-container-highest: #3E4944;

  --md-sys-color-secondary-container: #2C3631;
  --md-sys-color-on-secondary-container: #F5F2EA;

  /* Inverse: Light surface for dark mode overlays */
  --md-sys-color-inverse-surface: #F5F2EA;
  --md-sys-color-inverse-on-surface: #1E2622;

  /* Outlines: Hunter Green for borders, subtle variant for dividers */
  --md-sys-color-outline: #2D4E3C;
  --md-sys-color-outline-variant: rgba(255, 255, 255, 0.1);
  --md-sys-color-border-variant: rgba(255, 255, 255, 0.1);

  /* Text: Warm Clay (#F5F2EA) for main, muted for secondary */
  --md-sys-color-text-main: #F5F2EA;
  --md-sys-color-text-muted: rgba(245, 242, 234, 0.7);
  
  /* Links Modal Specific Colors (dark mode) */
  --wy-links-modal-text-muted: rgba(245, 242, 234, 0.7);
  --wy-links-modal-chip-border: rgba(255, 255, 255, 0.1);
  
  /* Dropdown Component Colors (dark mode) */
  --wy-dropdown-label-color: #A1A1AA;
  --wy-dropdown-text-color: #E4E4E7;
  --wy-dropdown-icon-color: #A1A1AA;
  --wy-dropdown-bg: #18181B;
  --wy-dropdown-border: #3F3F46;
  --wy-dropdown-menu-bg: #27272A;
  --wy-dropdown-item-hover-bg: #3F3F46;
  
  /* Info Panel Component Colors (dark mode) */
  --wy-info-panel-bg: rgba(24, 24, 27, 0.5);
  --wy-info-panel-border: #27272A;
  --wy-info-panel-text-color: #A1A1AA;
  
  /* Library Header Component Colors (dark mode) */
  --wy-status-success-color: #66BB8A;
  --wy-library-header-scrolled-bg: rgba(18, 18, 18, 0.3);
  
  /* Button System Tokens (dark mode) */
  --wy-button-primary-hover-bg: #3A5F4A;
  --wy-button-primary-shadow-hover: 0 10px 25px -5px rgba(45, 78, 60, 0.4);
  --wy-button-secondary-bg: var(--md-sys-color-surface-container);
  --wy-button-secondary-hover-bg: var(--md-sys-color-surface-container-high);
  --wy-button-outlined-border: rgba(255, 255, 255, 0.2);
  --wy-button-outlined-hover-bg: rgba(255, 255, 255, 0.05);
  --wy-button-text-fg: var(--md-sys-color-on-background);
  --wy-button-text-fg-muted: rgba(245, 242, 234, 0.6);
  --wy-button-text-hover-bg: rgba(255, 255, 255, 0.05);
  --wy-icon-button-filled-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  --wy-icon-button-outlined-bg: var(--md-sys-color-surface-container);
  --wy-icon-button-outlined-border: rgba(255, 255, 255, 0.2);
  --wy-utility-tag-bg: rgba(255, 255, 255, 0.05);
  --wy-utility-tag-fg: var(--md-sys-color-on-background);
  --wy-utility-tag-border: rgba(255, 255, 255, 0.1);
  --wy-utility-tag-add-border: rgba(255, 255, 255, 0.2);
  --wy-utility-tag-add-fg: rgba(255, 255, 255, 0.4);
}
