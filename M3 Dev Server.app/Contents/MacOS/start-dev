#!/bin/bash

# Kill any existing dev server on port 5173
lsof -ti:5173 | xargs kill -9 2>/dev/null

# Navigate to project directory
cd "/Users/mwy/Library/Mobile Documents/com~apple~CloudDocs/Projects/m3-design-v2"

# Source nvm if available (needed for npm when launched from Finder)
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"

# Start dev server in background
npm run dev &

# Wait for server to be ready (up to 30 seconds)
for i in {1..30}; do
    curl -s http://localhost:5173 > /dev/null 2>&1 && break
    sleep 1
done

# Open components-library.html in Chrome
open -a "Google Chrome" "http://localhost:5173/components-library.html"
